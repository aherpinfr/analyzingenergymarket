## Database Analysis
### Key takeaways
* 50% of the companies are traditional, 27% are renewables, 23% are one of the fourth other categories
* 94% of the revenues are generated by a traditional company, 5% by a renewable, 1% by one of the others
* Almost 90% of the employees are working for a traditional company, and 6% for renewables.
* On average there are more employees in a manufacturing or support company than in renewables, although renewables are generating more revenue

### Revenue Analysis
My first idea was to get statistics on the number of companies in each category in my sample

```sql
SELECT Category, COUNT(Category) AS Count FROM COMPANIES
GROUP BY Category
ORDER BY Count DESC
```
![image](https://github.com/aherpinfr/analyzingenergymarket/assets/89163892/aa6ef1f1-e48e-42b8-a687-017e987b46b0)

As you can see, traditional companies account for almost 50% of the total number of companies in the sample, while renewables account for around 27%.

Then I wanted to understand what it means in terms of revenues

```sql
SELECT Category, COUNT(Category) AS Count, 
sum(revenue_ttm) AS revenue,
avg(revenue_ttm) As avg_revenues
FROM COMPANIES
GROUP BY Category
ORDER BY avg_revenues DESC
```
![image](https://github.com/aherpinfr/analyzingenergymarket/assets/89163892/b94b5c93-a67d-4082-8dda-8eef8fd77405)

As we can see,  94% of the revenues in the table are generated by traditional companies, while 5% by renewables.

I know that all my revenue data have not been taken in the same year, though. I'll first search for the column that stores the year.

```sql
SELECT * FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME ='COMPANIES';
```
![image](https://github.com/aherpinfr/analyzingenergymarket/assets/89163892/60ddaeba-082e-4ede-a235-6e77095cdc38)

There is a column "year_revenuettm" that can be shown to get the statistics on when data on revenues have been stored.

```sql
SELECT year_revenuettm, COUNT(Category) AS Count FROM COMPANIES
GROUP BY year_revenuettm
ORDER BY Count DESC
```

![image](https://github.com/aherpinfr/analyzingenergymarket/assets/89163892/f0cb97e3-4272-4a0c-8969-12a6a361edcd)

As we can see in the picture above, 99% of revenue data have been retrieved within three years of range.

### Employees analysis
After having analyzed the sample on the revenue metric, I am going to compare the number of employees by category.

```sql
SELECT Category, COUNT(Category) AS Count, 
sum(Nb_employees)As total_employees,
avg(Nb_employees) As avg_nb_of_em
FROM COMPANIES
GROUP BY Category
ORDER BY Count DESC
```
![image](https://github.com/aherpinfr/analyzingenergymarket/assets/89163892/16c6061a-e724-401b-95c5-157c0dfffd31)

There is a total of 2 845 956 employees, almost 90% of which are working for a traditional company, and 6% for renewables.
On average there are more employees in a manufacturing or support company than in renewables, although renewables are generating more revenues.

## Conclusion
Even if they are not a majority (they are less the 50% of the total number of companies), companies in the traditional sector account for almost all revenues and employees. 
There is also a share for renewables companies (around 5%). 
